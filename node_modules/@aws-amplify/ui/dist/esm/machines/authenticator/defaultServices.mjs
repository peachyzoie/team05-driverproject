import{__awaiter as t,__generator as n,__assign as r}from"tslib";import{Amplify as i,Auth as s}from"aws-amplify";import"../../types/authenticator/user.mjs";import"../../types/authenticator/attributes.mjs";import"../../types/primitives/componentClassName.mjs";import"../../i18n/translations.mjs";import{hasSpecialChars as o}from"../../helpers/authenticator/utils.mjs";import"../../helpers/accountSettings/utils.mjs";var e={getAmplifyConfig:function(){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,i.configure()]}))}))},getCurrentUser:function(){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.currentAuthenticatedUser()]}))}))},handleSignUp:function(i){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.signUp(r(r({},i),{autoSignIn:{enabled:!0}}))]}))}))},handleSignIn:function(r){var i=r.username,o=r.password;return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.signIn(i,o)]}))}))},handleConfirmSignIn:function(r){var i=r.user,o=r.code,e=r.mfaType;return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.confirmSignIn(i,o,e)]}))}))},handleConfirmSignUp:function(r){var i=r.username,o=r.code;return t(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,s.confirmSignUp(i,o)];case 1:return[2,t.sent()]}}))}))},handleForgotPasswordSubmit:function(r){var i=r.username,o=r.code,e=r.password;return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.forgotPasswordSubmit(i,o,e)]}))}))},handleForgotPassword:function(r){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2,s.forgotPassword(r)]}))}))},validateCustomSignUp:function(r,i){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2]}))}))},validateFormPassword:function(r,i,s){return t(this,void 0,void 0,(function(){var t,e,u,a;return n(this,(function(n){return t=r.password,i.password&&s?(e=[],u=+(null==s?void 0:s.passwordPolicyMinLength),t.length<u&&e.push("Password must have at least ".concat(u," characters")),null==(a=null==s?void 0:s.passwordPolicyCharacters)||a.forEach((function(n){switch(n){case"REQUIRES_LOWERCASE":/[a-z]/.test(t)||e.push("Password must have lower case letters");break;case"REQUIRES_UPPERCASE":/[A-Z]/.test(t)||e.push("Password must have upper case letters");break;case"REQUIRES_NUMBERS":/[0-9]/.test(t)||e.push("Password must have numbers");break;case"REQUIRES_SYMBOLS":o(t)||e.push("Password must have special characters")}})),[2,0!==e.length?{password:e}:null]):[2,null]}))}))},validateConfirmPassword:function(r,i){return t(this,void 0,void 0,(function(){var t,s,o,e;return n(this,(function(n){return t=r.password,s=r.confirm_password,o=i.confirm_password,e=i.password,t||s?(t||s)&&t!==s&&(o&&e||(null==t?void 0:t.length)>=6&&(null==s?void 0:s.length)>=6)?[2,{confirm_password:"Your passwords must match"}]:[2]:[2,null]}))}))},validatePreferredUsername:function(r,i){return t(this,void 0,void 0,(function(){return n(this,(function(t){return[2]}))}))}};export{e as defaultServices};
